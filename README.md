By default, Mono uses signals to handle `NullReferenceException`. Applications
that want to use Mach exceptions to generate crash reports interfere with this,
because Mach exceptions take priority over signals. One workaround is to run
Mono with the `MONO_DEBUG=explicit-null-checks` environment variable; however,
this may be unacceptably slow depending on the application.

This repository illustrates one way of setting up Mach exception handling in a
manner compatible with Mono. It works by consulting the Mono runtime when an
exception occurs, chaining to the regular Mono signal handler if Mono indicates
that the exception was generated by managed code.

`make` should build the native library and the example program, which should
produce output like the following when run with `mono exception-negotiation.exe`:

```
Got managed exception; forwarding.
System.NullReferenceException: Object reference not set to an instance of an object
  at Test.Main (System.String[] arguments) <0x699ed8 + 0x0002b> in <filename unknown>:0
Got unmanaged exception; generating crash report.
```

That is, we generate a managed exception and see that it’s forwarded properly to
Mono, then generate a native abort and see that it generates a “crash report”.
